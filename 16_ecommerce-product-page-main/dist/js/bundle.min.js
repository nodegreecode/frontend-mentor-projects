(()=>{"use strict";const e=(e,t)=>{let n=0,i=[];const o=document.getElementById("slides"),r=document.getElementById("leftArrow"),c=document.getElementById("rightArrow"),s=document.querySelectorAll(".image-box__image").length,d=document.querySelectorAll(".image-box__image"),a=document.getElementById("currentProductImage");function l(e){e.forEach((e=>{e.classList.remove("selected"),e.querySelector(".overlay")?.remove()}))}function u(e){l(d),e.classList.add("selected");const t=document.createElement("div");t.classList.add("overlay"),e.appendChild(t);const n=e.querySelector("source:nth-of-type(2)")?.getAttribute("srcset");a.setAttribute("src",n)}return r.addEventListener("click",(t=>{(t=>{t.preventDefault(),e.publish("previousPicture",n-1)})(t)})),c.addEventListener("click",(t=>{(t=>{t.preventDefault(),e.publish("nextPicture",n+1)})(t)})),{getImageContainers:()=>d,deselectImage(e){l(e)},handleProductImage(){i.forEach((({element:e,handler:t})=>{e.removeEventListener("click",t)})),i=[],window.matchMedia("(min-width: 720.5px)").matches&&(i=Array.from(d).map((e=>{const t=()=>u(e);return e.addEventListener("click",t),{element:e,handler:t}})),u(d[0]),t.getMobileMenu().open&&t.closeMobileMenu())},goToSlide(e){e<0?e=s-1:e>=s&&(e=0),n=e,o.style.transform=`translateX(-${100*n}%)`}}},t=e=>{let t=0;const n=document.getElementById("lightboxTrigger"),i=document.getElementById("lightboxModal"),o=document.getElementById("lightboxCloseButton"),r=document.querySelectorAll(".lightbox__thumbnail"),c=document.getElementById("lighboxCurrentImage"),s=document.getElementById("lightboxPrevious"),d=document.getElementById("ligthboxNext"),a=Array.from(r).map((e=>e.firstElementChild.getAttribute("src")));function l(e){return e.replace(/-thumbnail/g,"")}function u(e){r.forEach((e=>{e.classList.remove("selected"),e.querySelector(".overlay")?.remove()})),e.classList.add("selected");const t=document.createElement("div");t.classList.add("overlay"),e.appendChild(t);const n=e.firstElementChild.getAttribute("src");c.setAttribute("src",l(n))}return n.addEventListener("click",(()=>e.publish("openLightBox"))),o.addEventListener("click",(()=>e.publish("closeLightBox"))),s.addEventListener("click",(()=>e.publish("selectLightboxPreviousProductImage"))),d.addEventListener("click",(()=>{e.publish("selectLightboxNextProductImage",a)})),{selectProductImage(){r.forEach((e=>{e.addEventListener("click",(()=>u(e)))}))},openLightBox(){i.open||i.showModal()},closeLightBox(){i.open&&i.close()},selectPreviousProductImage(){const e=Array.from(r).map((e=>e.firstElementChild.getAttribute("src")));t>0?t--:t=e.length-1;const n=l(e[t]);c.setAttribute("src",n),u(r[t])},selectNextProductImage(e){t<e.length-1?t++:t=0;const n=l(e[t]);c.setAttribute("src",n),u(r[t])}}},n=e=>{const t={id:234,name:"Fall limited Edition Sneakers",newPrice:125,oldPrice:250,discount:50};let n=[];const i=document.getElementById("shoppingCartButton"),o=document.getElementById("shoppingCart"),r=document.getElementById("increaseQuantity"),c=document.getElementById("decreaseQuantity"),s=document.getElementById("productQuantityWrapper"),d=document.getElementById("productQuanity"),a=document.getElementById("addToCartButton"),l=document.querySelector(".details-box__description"),u=document.getElementById("itemCount"),m=document.getElementById("item-list"),g=document.querySelector(".shopping-cart__items-container");function p(e,t="en-US"){return new Intl.NumberFormat(t,{style:"currency",currency:"USD"}).format(e)}function b(){c.disabled=parseInt(d.value)<=d.min,r.disabled=parseInt(d.value)>=d.max}function h(e){const i=new CustomEvent("itemAdded",{detail:{quantity:e.quantity}}),o=n.find((t=>t.id===e.product.id));o?o.quantity=e.quantity:n.push({id:t.id,name:t.name,price:t.newPrice,quantity:e.quantity}),document.dispatchEvent(i)}function y(e){e>0?(u.classList.remove("hidden"),u.textContent=e):u.classList.add("hidden")}function v(){m.innerHTML="";const e=document.getElementById("checkout-button");e&&g.removeChild(e);const t=document.createElement("li");0===n.length?(t.innerHTML='\n          <p class="shopping-cart__empty-message">\n            Your cart is empty.\n          </p>\n        ',m.appendChild(t)):n.forEach((e=>{const n=e.price*e.quantity;t.classList.add("shopping-cart__item"),t.innerHTML=`\n        <div class="shopping-cart__image-box"><img src=".//images/image-product-1-thumbnail.jpg" alt="" /></div>\n        <h3 class="shopping-cart__item-title">\n        ${e.name}\n        </h3>\n        <p class="shopping-cart__item-price">\n        ${p(e.price)} x ${e.quantity}\n        <span class="shopping-cart__item-total-price">${p(n)}</span>\n        </p>\n        <div class="shopping-cart__action">\n        <button id="remove-button">\n        <img src=".//images/icon-delete.svg" alt="" />\n        </button>\n        </div>`,m.appendChild(t),document.getElementById("remove-button").addEventListener("click",(()=>E(e.id)));m.insertAdjacentHTML("afterend",'\n        <a id="checkout-button" href="#" class="shopping-cart__checkout-button">Checkout</a>\n        ')}))}const E=t=>{e.publish("removeFromCart",t)};return i.addEventListener("click",(()=>e.publish("toggleShoppingCart"))),s.addEventListener("click",(t=>e.publish("changeQuantity",t.target))),a.addEventListener("click",(()=>e.publish("addToCart"))),document.addEventListener("itemAdded",(e=>{v(),y(e.detail.quantity)})),document.addEventListener("toggleCart",(()=>{v()})),document.addEventListener("itemRemoved",(()=>{v(),y(0)})),{getShoppingCartButton:()=>i,getCart:()=>o,renderProduct(){const e=Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),n=document.createElement("div"),i=`                \n        <div>\n          <p class="details-box__new-price">${e.format(t.newPrice)}</p><span class="details-box__discount">${t.discount}%</span>\n        </div>\n        <p class="details-box__old-price">${e.format(t.oldPrice)}</p>`;n.classList.add("details-box__price-container","flex-container","gap-12-deskto","mb-1"),n.innerHTML=i,l.insertAdjacentElement("afterend",n)},openShoppingCart(){const e=new Event("toggleCart");o.hidden=!o.hidden,document.dispatchEvent(e)},changeProductQuantity(e){if("decreaseQuantity"==e.id||e.classList.contains("details-box__minus-icon")){const e=parseInt(d.value)-1;e>=d.min&&(d.value=e,b())}if("increaseQuantity"==e.id||e.classList.contains("details-box__plus-icon")){const e=parseInt(d.value||0)+1;e<=d.max&&(d.value=e,b())}},addItemToCart(){const e=function(){const e=parseInt(d.value);if(isNaN(e))throw new TypeError("Only positive numbers are allowed");if(e<=d.min)throw new RangeError("Value must be greater then 0");if(e>d.max)throw new RangeError("Value must be less then 100");return{quantity:e,product:t}}();e.quantity,h(e)},removeItemFromCart(e){!function(e){const t=new Event("itemRemoved");n=n.filter((t=>t.id!==e)),document.dispatchEvent(t)}(e)}}};document.addEventListener("DOMContentLoaded",(()=>{const i=(()=>{let e={};return{subscribe(t,n){e[t]=e[t]||[],e[t].push(n)},publish(t,n){e[t].forEach((e=>{e(n)}))}}})(),o=n(i),r=((e,t)=>{const n=document.getElementById("mobileMenuOpenBtn"),i=document.getElementById("mobileMenuCloseBtn"),o=document.getElementById("mobileMenu"),r=document.querySelector(".avatar");return n.addEventListener("click",(()=>e.publish("openMobileMenu"))),i.addEventListener("click",(()=>e.publish("closeMobileMenu"))),{getMobileMenu:()=>o,openMobileMenu(){o.showModal(),t.getShoppingCartButton().style.zIndex="-10",r.style.zIndex="-10",t.getCart().style.zIndex="-10"},closeMobileMenu(){o.close(),t.getShoppingCartButton().style.zIndex="initial",r.style.zIndex="initial",t.getCart().style.zIndex="initial"}}})(i,o),c=e(i,r),s=t(i),d=((e,t,n)=>({resizeObserver(){new ResizeObserver((()=>{e.publish("productImageSelect"),e.publish("handleMobileView",{images:t.getImageContainers(),i:0})})).observe(document.body)},handleMobileView(e){720===window.innerWidth||window.innerWidth<720?(t.deselectImage(e.images),n.closeLightBox()):(721===window.innerWidth||window.innerWidth>721)&&t.goToSlide(e.i)}}))(i,c,s);i.subscribe("renderProduct",o.renderProduct),i.subscribe("addToCart",o.addItemToCart),i.subscribe("removeFromCart",o.removeItemFromCart),i.subscribe("toggleShoppingCart",o.openShoppingCart),i.subscribe("changeQuantity",o.changeProductQuantity),i.subscribe("openMobileMenu",r.openMobileMenu),i.subscribe("closeMobileMenu",r.closeMobileMenu),i.subscribe("productImageSelect",c.handleProductImage),i.subscribe("previousPicture",c.goToSlide),i.subscribe("nextPicture",c.goToSlide),i.subscribe("handleMobileView",d.handleMobileView),i.subscribe("resizing",d.resizeObserver),i.subscribe("openLightBox",s.openLightBox),i.subscribe("closeLightBox",s.closeLightBox),i.subscribe("selectLightboxPreviousProductImage",s.selectPreviousProductImage),i.subscribe("selectLightboxNextProductImage",s.selectNextProductImage),i.subscribe("selectProductImage",s.selectProductImage),i.publish("resizing"),i.publish("selectProductImage"),i.publish("renderProduct")}))})();